<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Quaderno Finanze Personali</title>
  <style>
    /* ---------- STILE QUADERNO ---------- */
    :root{
      --line-height: 28px;
      --line-color: #c5d0e2;
      --paper-bg: #fbfbfc;
    }
    *{box-sizing:border-box;font-family:"Courier New", Courier, monospace;margin:0;padding:0}
    body{
      padding:2rem;
      background:repeating-linear-gradient(var(--paper-bg) 0 var(--line-height),var(--line-color) var(--line-height) calc(var(--line-height)+1px));
      color:#222;
    }
    h1{text-align:center;margin-bottom:2rem;font-size:2rem;letter-spacing:1px}
    .container{max-width:1200px;margin:0 auto}

    /* ---------- CARDS ---------- */
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:2rem}
    .card{background:#fff5;border:1px solid #7773;padding:1rem;border-radius:8px;text-align:center}
    .card h2{font-size:0.9rem;color:#3a3a3a;margin-bottom:0.3rem}
    .card p{font-size:1.4rem;font-weight:700}
    .income-color{color:#2e7d32}
    .expense-color{color:#c62828}

    /* ---------- TABLES ---------- */
    table{width:100%;border-collapse:collapse;background:#fff5;border:1px solid #7773;margin-bottom:3rem}
    thead{background:#3c3c3c;color:#fff}
    th,td{padding:0.5rem 0.6rem;text-align:center;font-size:0.9rem}
    tbody tr:nth-child(even){background:#f7f7f7c7}
    tbody td.income{color:#2e7d32;font-weight:600}
    tbody td.expense{color:#c62828;font-weight:600}
    tbody td.balance{font-weight:700}
    h2{margin:1.8rem 0 0.6rem;font-size:1.2rem;text-decoration:underline;}

    /* separatore mese nella tabella transazioni */
    .month-sep td{background:#d0d7e6;font-weight:700;text-align:left;font-size:1rem;padding-left:0.4rem}
  </style>
</head>
<body>
  <h1>Prospetto Entrate &amp; Uscite</h1>
  <div class="container">
    <!-- SUMMARY CARDS -->
    <section id="summary-cards" class="cards"></section>

    <!-- MONTHLY SUMMARY -->
    <h2>Riepilogo Mensile</h2>
    <table id="monthly-table">
      <thead>
        <tr><th>Mese</th><th>Entrate</th><th>Uscite</th><th>Saldo Finale</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- TRANSAZIONI -->
    <h2>Dettaglio Transazioni</h2>
    <table id="transactions-table">
      <thead>
        <tr><th>Data</th><th>Categoria</th><th>Tipo</th><th>Importo</th><th>Saldo dopo operazione</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
/************** DATI **************/
const startBalance = 6100;
const transactions = [
  {date:"2025-06-26",category:"Tabacco",type:"Spesa",amount:20},
  {date:"2025-06-26",category:"Netflix",type:"Spesa",amount:19},
  {date:"2025-06-27",category:"Aereo Sicilia",type:"Spesa",amount:53},
  {date:"2025-06-28",category:"Will",type:"Spesa",amount:7},
  {date:"2025-06-30",category:"Affitto",type:"Spesa",amount:680},
  {date:"2025-07-01",category:"Stipendio",type:"Entrata",amount:1650},
  {date:"2025-07-01",category:"Ticket Edenred",type:"Entrata",amount:160},
  {date:"2025-07-15",category:"Tredicesima",type:"Entrata",amount:1300},
  {date:"2025-07-19",category:"NowTV",type:"Spesa",amount:5},
  {date:"2025-07-31",category:"Affitto",type:"Spesa",amount:680},
  {date:"2025-08-01",category:"Stipendio",type:"Entrata",amount:1650},
  {date:"2025-08-10",category:"Rimborso 730",type:"Entrata",amount:400},
  {date:"2025-08-31",category:"Affitto",type:"Spesa",amount:680},
  {date:"2025-09-01",category:"Stipendio",type:"Entrata",amount:1650},
  {date:"2025-09-30",category:"Affitto",type:"Spesa",amount:680},
  {date:"2025-10-01",category:"Stipendio",type:"Entrata",amount:1650},
  {date:"2025-10-01",category:"Ticket Edenred",type:"Entrata",amount:160},
  {date:"2025-10-30",category:"Affitto",type:"Spesa",amount:680}
];

/******** UTILITÃ€ ********/  
const eur = v =>
  (Math.round(v)).toLocaleString("it-IT",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0});

transactions.sort((a,b)=> new Date(a.date)-new Date(b.date));

/******** CALCOLO ********/  
let running = startBalance;
transactions.forEach(t=>{
  running += t.type==="Entrata"? +t.amount : -t.amount;
  t.balance = running;
});

const monthly = {};
transactions.forEach(t=>{
  const m=t.date.slice(0,7);
  if(!monthly[m]) monthly[m]={entrate:0,uscite:0,saldo:0};
  if(t.type==="Entrata") monthly[m].entrate += t.amount; else monthly[m].uscite += t.amount;
  monthly[m].saldo = t.balance;
});

/******** CARD SUMMARY ********/  
const cardsWrap=document.getElementById("summary-cards");
const totIn=transactions.filter(t=>t.type==='Entrata').reduce((s,t)=>s+t.amount,0);
const totOut=transactions.filter(t=>t.type==='Spesa').reduce((s,t)=>s+t.amount,0);
const cards=[
  {l:"Saldo iniziale",v:eur(startBalance)},
  {l:"Entrate totali",v:eur(totIn),cls:"income-color"},
  {l:"Uscite totali",v:eur(totOut),cls:"expense-color"},
  {l:"Saldo corrente",v:eur(running)}
];
cards.forEach(c=>{
  const div=document.createElement('div');div.className='card';
  div.innerHTML=`<h2>${c.l}</h2><p class="${c.cls||''}">${c.v}</p>`;
  cardsWrap.appendChild(div);
});

/******** TABELLA MENSILE ********/  
const mBody=document.querySelector('#monthly-table tbody');
Object.keys(monthly).sort().forEach(m=>{
  const {entrate,uscite,saldo}=monthly[m];
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${m}</td><td class="income">${eur(entrate)}</td><td class="expense">${eur(uscite)}</td><td class="balance">${eur(saldo)}</td>`;
  mBody.appendChild(tr);
});

/******** DETTAGLIO TRANSAZIONI PER MESE ********/  
const txBody=document.querySelector('#transactions-table tbody');
let currentMonth="";
transactions.forEach(t=>{
  const m=t.date.slice(0,7);
  if(m!==currentMonth){
    currentMonth=m;
    const sep=document.createElement('tr');sep.className='month-sep';
    const [y,mm]=m.split('-');
    const meseLabel=new Date(`${m}-01`).toLocaleString('it-IT',{month:'long',year:'numeric'});
    sep.innerHTML=`<td colspan="5">${meseLabel.charAt(0).toUpperCase()+meseLabel.slice(1)}</td>`;
    txBody.appendChild(sep);
  }
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${t.date}</td><td>${t.category}</td><td>${t.type}</td><td class="${t.type==='Entrata'?'income':'expense'}">${eur(t.amount)}</td><td class="balance">${eur(t.balance)}</td>`;
  txBody.appendChild(tr);
});
</script>
</body>
</html>
